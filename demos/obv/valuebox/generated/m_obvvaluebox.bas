Attribute VB_Name = "m_obvvaluebox"
'Generated by IDL2VB v121. Copyright (c) 2000-2003 Martin.Both
'Source File Name: ../demos/obv/valuebox/box.idl

Option Explicit

'module ::obv::valuebox

'ValueBox longBox, Helper
Public Function longBox_TypeCode() As cOrbTypeCode
    On Error GoTo ErrHandler
    Dim sTypeId As String
    sTypeId = "IDL:obv/valuebox/longBox:1.0"
    Dim oOrb As cOrbImpl
    Set oOrb = VBOrb.defaultOrb()
    'Get previously created recursive or concrete TypeCode
    Dim oRecTC As cOrbTypeCode
    Set oRecTC = oOrb.getRecursiveTC(sTypeId, 30) 'mCB.tk_value_box
    If oRecTC Is Nothing Then
        'Create place holder for TypeCode to avoid endless recursion
        Set oRecTC = oOrb.createRecursiveTc(sTypeId)
        On Error GoTo ErrRollback
        'Describe ValueBox
        Dim oBoxedType As cOrbTypeCode
        Set oBoxedType = oOrb.createPrimitiveTc(3) 'VBOrb.TCLong
        'Overwrite place holder
        Call oRecTC.setRecTc2ValueBoxTc("longBox", oBoxedType)
    End If
    Set longBox_TypeCode = oRecTC
    Exit Function
ErrRollback:
    Call oRecTC.destroy
ErrHandler:
    Call VBOrb.ErrReraise(Err, "longBox_TypeCode")
End Function

'ValueBox longSeqBox, Helper
Public Function longSeqBox_TypeCode() As cOrbTypeCode
    On Error GoTo ErrHandler
    Dim sTypeId As String
    sTypeId = "IDL:obv/valuebox/longSeqBox:1.0"
    Dim oOrb As cOrbImpl
    Set oOrb = VBOrb.defaultOrb()
    'Get previously created recursive or concrete TypeCode
    Dim oRecTC As cOrbTypeCode
    Set oRecTC = oOrb.getRecursiveTC(sTypeId, 30) 'mCB.tk_value_box
    If oRecTC Is Nothing Then
        'Create place holder for TypeCode to avoid endless recursion
        Set oRecTC = oOrb.createRecursiveTc(sTypeId)
        On Error GoTo ErrRollback
        'Describe ValueBox
        Dim oBoxedType As cOrbTypeCode
        Set oBoxedType = oOrb.createPrimitiveTc(3) 'VBOrb.TCLong
        Set oBoxedType = oOrb.createSequenceTc(0, oBoxedType)
        'Overwrite place holder
        Call oRecTC.setRecTc2ValueBoxTc("longSeqBox", oBoxedType)
    End If
    Set longSeqBox_TypeCode = oRecTC
    Exit Function
ErrRollback:
    Call oRecTC.destroy
ErrHandler:
    Call VBOrb.ErrReraise(Err, "longSeqBox_TypeCode")
End Function
