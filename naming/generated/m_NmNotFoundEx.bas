Attribute VB_Name = "m_NmNotFoundEx"
'Generated by IDL2VB v121. Copyright (c) 2000-2003 Martin.Both
'Source File Name: ../naming/CosNaming.idl

Option Explicit

'exception ::CosNaming::NamingContext::NotFound
Public Const TypeId As String = "IDL:omg.org/CosNaming/NamingContext/NotFound:1.0"

'Helper
Public Function TypeCode() As cOrbTypeCode
    On Error GoTo ErrHandler
    Dim oOrb As cOrbImpl
    Set oOrb = VBOrb.defaultOrb()
    'Get previously created recursive or concrete TypeCode
    Dim oRecTC As cOrbTypeCode
    Set oRecTC = oOrb.getRecursiveTC(TypeId, 22) 'mCB.tk_except
    If oRecTC Is Nothing Then
        'Create place holder for TypeCode to avoid endless recursion
        Set oRecTC = oOrb.createRecursiveTc(TypeId)
        On Error GoTo ErrRollback
        'Describe exception members
        Dim oMemSeq As cCBStructMemberSeq
        Set oMemSeq = New cCBStructMemberSeq
        oMemSeq.Length = 2
        Set oMemSeq.Item(0) = New cCBStructMember
        oMemSeq.Item(0).name = "why"
        Set oMemSeq.Item(0).p_type = m_NmContext.NotFoundReason_TypeCode()
        Set oMemSeq.Item(1) = New cCBStructMember
        oMemSeq.Item(1).name = "rest_of_name"
        Set oMemSeq.Item(1).p_type = m_NmNameComponent.TypeCode()
        Set oMemSeq.Item(1).p_type = oOrb.createSequenceTc(0, oMemSeq.Item(1).p_type)
        Set oMemSeq.Item(1).p_type = oOrb.createAliasTc("IDL:omg.org/CosNaming/Name:1.0", "Name", oMemSeq.Item(1).p_type)
        'Overwrite place holder
        Call oRecTC.setRecTc2ExceptionTc("NotFound", oMemSeq)
    End If
    Set TypeCode = oRecTC
    Exit Function
ErrRollback:
    Call oRecTC.destroy
ErrHandler:
    Call VBOrb.ErrReraise(Err, "TypeCode")
End Function

'Helper, oAny.writeValue() -> exception.initByRead()
Public Function extractFromAny(ByVal oAny As cOrbAny) As c_NmNotFoundEx
    Dim oException As c_NmNotFoundEx
    Set oException = New c_NmNotFoundEx
    Call oException.initByAny(oAny)
    Set extractFromAny = oException
End Function

'Helper, exception.writeMe() -> oAny.initByReadValue()
Public Function cloneAsAny(ByVal oException As c_NmNotFoundEx) As cOrbAny
    On Error GoTo ErrHandler
    Dim oAny As cOrbAny
    Set oAny = New cOrbAny
    Call oAny.initByDefaultValue(TypeCode())
    Call oException.insertIntoAny(oAny)
    Set cloneAsAny = oAny
    Exit Function
ErrHandler:
    Call VBOrb.ErrReraise(Err, "cloneAsAny")
End Function
